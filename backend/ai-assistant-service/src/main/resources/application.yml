server:
  port: 8088

spring:
  application:
    name: ai-assistant-service

  # PostgreSQL for structured data
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5433}/${DB_NAME:axonrh}
    username: ${DB_USER:axonrh}
    password: ${DB_PASSWORD:axonrh123}
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
    show-sql: false

  # MongoDB for conversation history
  data:
    mongodb:
      uri: ${MONGODB_URI:mongodb://localhost:27017/axonrh_conversations}
      database: axonrh_conversations

  # Flyway
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    baseline-version: 0

# LLM Configuration
ai:
  openai:
    api-key: ${OPENAI_API_KEY:}
    model: gpt-4-turbo-preview
    max-tokens: 4096
    temperature: 0.7
    timeout-seconds: 60

  anthropic:
    api-key: ${ANTHROPIC_API_KEY:}
    model: claude-3-sonnet-20240229
    max-tokens: 4096

  # Default provider
  default-provider: ${AI_PROVIDER:openai}

  # Embeddings
  embeddings:
    model: text-embedding-3-small
    dimensions: 1536

  # Rate limiting
  rate-limit:
    requests-per-minute: 60
    tokens-per-minute: 100000

# Vector Database (Milvus)
milvus:
  host: ${MILVUS_HOST:localhost}
  port: ${MILVUS_PORT:19530}
  collection-name: hr_knowledge_base

# Assistant Configuration
assistant:
  system-prompt: |
    Você é o Assistente de RH da AxonRH, uma plataforma avançada de gestão de recursos humanos.

    Suas capacidades incluem:
    - Responder perguntas sobre políticas de RH e procedimentos
    - Ajudar com cálculos trabalhistas (férias, rescisão, horas extras)
    - Fornecer informações sobre legislação trabalhista brasileira
    - Consultar dados de funcionários, folha de pagamento e benefícios
    - Gerar relatórios e análises

    Regras importantes:
    - Sempre responda em português brasileiro
    - Seja preciso com cálculos e datas
    - Cite a legislação quando relevante (CLT, eSocial)
    - Proteja informações sensíveis dos funcionários
    - Quando não souber algo, indique claramente

    Contexto atual:
    - Data: {current_date}
    - Empresa: {company_name}
    - Usuário: {user_name}
    - Cargo: {user_role}

  # Knowledge base update interval (hours)
  knowledge-update-interval: 24

  # Conversation settings
  conversation:
    max-history: 50
    context-window: 10
    auto-summarize-after: 20

# Security
security:
  jwt:
    secret: ${JWT_SECRET:your-secret-key}
    expiration: 86400000

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics,prometheus
  endpoint:
    health:
      show-details: when_authorized

# Logging
logging:
  level:
    com.axonrh.ai: DEBUG
    org.springframework.data.mongodb: INFO

axonrh:
  flyway:
    repair-on-startup: true
