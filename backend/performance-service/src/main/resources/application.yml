spring:
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5433}/${DB_NAME:axonrh}
    username: ${DB_USER:axonrh}
    password: ${DB_PASSWORD:axonrh123}
    driver-class-name: org.postgresql.Driver
    hikari:
      minimum-idle: 5
      maximum-pool-size: 10
      idle-timeout: 300000
      connection-timeout: 20000
  flyway:
    enabled: true
    locations: classpath:db/migration
    baseline-on-migrate: true
    baseline-version: 0
    table: performance_service_schema_history
    schemas: shared
    default-schema: shared
    create-schemas: true
  jpa:
    hibernate:
      ddl-auto: validate
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        default_schema: shared
    open-in-view: false
    show-sql: ${SHOW_SQL:false}

  # Security
  security:
    oauth2:
      resourceserver:
        jwt:
          # issuer-uri: ${JWT_ISSUER:http://axonrh-auth-service:8081}
          # Para HS256 (chave simetrica) usamos secret-key
          # A chave deve ter pelo menos 256 bits (32 caracteres)
          secret-key: ${JWT_SECRET:axonrh-jwt-secret-key-change-in-production-2026}
          jws-algorithms: HS256

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info,prometheus
      base-path: /actuator
  endpoint:
    health:
      show-details: when-authorized
  health:
    defaults:
      enabled: true

